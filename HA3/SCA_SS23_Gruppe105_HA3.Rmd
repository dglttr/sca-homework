---
title: "Gruppe 105 Hausaufgabe 3"
subtitle: "Supply Chain Analytics SS23"
author: "Cordelia Mena Hernandez, Daniel Glatter"
date: "2023-06-07"
output: pdf_document
header-includes:
  \usepackage{fvextra}
  \DefineVerbatimEnvironment{Highlighting}{Verbatim}{breaklines,commandchars=\\\{\}}
---

```{r setup, include=FALSE}
# Laden von Packages
library(tidyverse)
library(lubridate)
library(forecast)
library(zoo)
library(scales)
library(ggplot2)
library(knitr)
opts_chunk$set(tidy.opts=list(width.cutoff=60),tidy=TRUE, echo = TRUE, warning = FALSE, message = FALSE)
```

# Daten für die Modellierung vorbereiten

## Aufgabe 1
```{r}
# Laden der Daten in die Dataframes 'services' und 'externals'
externals <- read.csv("externals20.csv", sep=";", dec=",")
services <- read.csv("../HA1/data/output_services_8Players_v0020.csv", sep=";", dec=",")

# Tabelle Externals aufbereiten
# Characters in Factors umwandeln
externals$region <- as.factor(externals$region)

# Periode anpassen
externals$Period <- format(make_date(year=externals$Year, month = externals$Month), "%Y%m")
externals <-subset(externals, select=-c(Year, Month))

# Tabelle Services aufbereiten
# Umwandlung ins Datumsformat
services$Date <- make_date(services$Year, services$Month, services$Day)
services <- subset(services, select=-c(Year, Month, Day))

# Characters in Factors umwandeln
services$region = as.factor(services$region)
services$storename = as.factor(services$storename)
services$Product = as.factor(services$Product)
services$vendor = as.factor(services$vendor)
services$service = as.factor(services$service)

# Periode hinzufügen
services$Period <- format(services$Date, "%Y%m")

# OTD, IFR berechnen
services$IFR <- services$QExecuted / services$QScheduled
services$OTD <- services$DaysExecuted <= services$DaysScheduled  # true/false

# LDL nach OTD aggregieren
ldl_otd <- services %>%
  group_by(Logistikdienstleister=vendor, service) %>%
  summarize(OTD = mean(OTD)) %>%
  arrange(OTD)

ldl_otd %>% kable(caption="Logistikdienstleister nach On-Time Delivery Rate", digits=3)

```

```{r}
# Tabelle nach IFR aggregieren
ldl_ifr <- services %>%
  group_by(Logistikdienstleister=vendor, service) %>%
  summarize(IFR = mean(IFR)) %>%
  arrange(IFR)

ldl_ifr %>% kable(caption="Logistikdienstleister nach In-Full Rate", digits=3)
```


## Aufgabe 2

```{r}
# Daten nach Monat zusammenfassen
ldl_ifr_warehousing <- services %>%
  filter(service == "Warehousing") %>%
  group_by(Logistikdienstleister=vendor, Region=region, Periode=Period) %>%
  summarize(IFR = mean(IFR)) %>%
  arrange(IFR)

ldl_ifr_warehousing %>% kable(caption='In-Full Rate der Warehousing-LDL nach Region und Periode', digits=3)
```

```{r}
# Insgesamt bester Warehousing-LDL
ldl_ifr_warehousing %>%
  group_by(Logistikdienstleister) %>%
  summarize(IFR=mean(IFR)) %>%
  arrange(desc(IFR)) %>%
  head(1) %>%
  kable(caption="Bester LDL nach IFR, über Regionen und Perioden hinweg", digits=3)
```

Der insgesamt beste LDL über alle Regionen und Perioden hinweg ist Flying Mercury Warehousing mit einer IFR von 83,7%.

```{r}
# Schlechtester IFR‐Wert (und Periode) dieses LDL
ldl_ifr_warehousing %>%
  filter(Logistikdienstleister == "Flying Mercury Warehousing") %>%
  filter(Region == "Shangh") %>%
  arrange(IFR) %>%
  head(1) %>%
  kable(caption="Schlechtester IFR-Wert und Periode von Flying Mercury Warehousing in der Region Shanghai", digits=3)
```

Der schlechteste IFR-Wert von Flying Mercury Warehousing in der Region Shanghai beträgt 78,4% und war im Mai 2022.

## Aufgabe 3

```{r}
# Daten nach Monat zusammenfassen
ldl_ifr_shipping <- services %>%
  filter(service == "Shipping") %>%
  group_by(Logistikdienstleister=vendor, Region=region, Periode=Period) %>%
  summarize(OTD = mean(OTD)) %>%
  # Sortieren nach OTD Rate
  arrange(OTD)

ldl_ifr_shipping %>% kable(caption='On-Time Delivery Rate der Shipping-LDL nach Region und Periode', digits=3)
```

```{r}
# Schlechtester OTD‐Wert in Japan im April 2019
ldl_ifr_shipping %>%
  filter(Periode == "201904") %>%
  filter(Region == "Japan") %>%
  arrange(OTD) %>%
  head(1) %>%
  kable(caption="Aufsteigend sortierte OTD-Werte von LDL in der Region Japan im April 2019", digits=3)
```

Der schlechteste OTD-Wert eines Shipping-LDL in der Region Japan im April 2019 beträgt 7.1%. Betroffen ist der Dienstleister CPS Shipping.


# Modellierung: Warehousing

## Aufgabe 4

```{r}

```

## Aufgabe 5

```{r}

```

## Aufgabe 6

```{r}

```

## Aufgabe 7

```{r}

```


## Aufgabe 8

```{r}

```

```{r}

```


## Aufgabe 9

```{r}

```

## Aufgabe 10

```{r}

```

## Aufgabe 11

```{r}

```

## Aufgabe 12
```{r}

```

# Entscheidung
## Aufgabe 13

```{r}

```

