---
title: "Case Study - Gruppen 105 & 201"
subtitle: "Supply Chain Analytics SS23"
author: "Benjamin Grünwald, Cordelia Mena Hernandez, Daniel Glatter, Vinzenz Tom Andreas Schaak"
date: "2023-06-21"
output: pdf_document
header-includes:
  \usepackage{fvextra}
  \DefineVerbatimEnvironment{Highlighting}{Verbatim}{breaklines,commandchars=\\\{\}}
---

```{r setup, include=FALSE}
# Laden von Packages
library(tidyverse)
library(readxl)
library(lubridate)
library(forecast)
library(zoo)
library(scales)
library(ggplot2)
library(knitr)
library(GGally)
opts_chunk$set(tidy.opts=list(width.cutoff=60),tidy=TRUE, echo = TRUE, warning = FALSE, message = FALSE)
```

# CRISP-DM Phase 1: Problemidentifizierung
- Kurze Beschreibung Unternehmen/Setting
- Kurze Beschreibung Verständnis Aufgabenstellung
- Input vom Unternehmen
  - Wenige Stock-outs -> stimmt das? Impact?
  - Stock-outs nur wegen mangelnder Verfügbarkeit auf dem Weltmarkt
  - Reduzierung der Mindestbestände und Sicherheitsbestände
  - Optimierung Bestellmengen (schneller Lagerumschlag, ohne Stock-outs)
- Unsere Überlegungen
- Unser Ansatz

# CRISP-DM Phase 2: Datenbeschaffung
- Hier Daten erhalten
- High-Level Beschreibung: Um welche Daten handelt es sich?

# CRISP-DM Phase 3: Datenaufbereitung
```{r}
materialverlauf <- read_excel("data/MBG_Materialverlauf_20230612.xlsx")

# Datentypen konvertieren
materialverlauf$ArtikelNr <- as.factor(materialverlauf$ArtikelNr)
materialverlauf$`Artikel-Bezeichnung` <- as.factor(materialverlauf$`Artikel-Bezeichnung`)
materialverlauf$EinAutDatTyp <- as.factor(materialverlauf$EinAutDatTyp)
materialverlauf$PjNr <- as.factor(materialverlauf$PjNr)
materialverlauf$PjInfo <- as.factor(materialverlauf$PjInfo)
materialverlauf$ORGAKzl <- as.factor(materialverlauf$ORGAKzl)
materialverlauf$EinAusDat <- as.Date(materialverlauf$EinAusDat)
materialverlauf$BstDat <- as.Date(materialverlauf$BstDat)

head(materialverlauf) %>% kable(caption="Ausgabe der ersten 6 Zeilen des Materialverlaufs")
```
```{r}
# Zusammenfassung über Daten ausgeben
summary(materialverlauf)
```

```{r}
gruppe_b_materialien <- c("DAS N-TOPcon Bifacial Glas-Glas (2+2mm) Black 415 WP",
                         "Rahmenloser Bildhalter Antireflexglas 29,7 x 42",
                         "Kabelbinder 280x4,5 mm schwarz",
                         "FPKU-EM-F PVC- Rohr grau EN50 L=3m",
                         "FINTECH Alu Steckrohr IESR 40 AL (3m)",
                         "3d-U-Scheiben     8,4   M 8         DIN 9021  A2")

mat_verlauf_gruppeB <- materialverlauf[materialverlauf$`Artikel-Bezeichnung` %in% gruppe_b_materialien,]
summary(mat_verlauf_gruppeB)
```


```{r}
# Visualisierung des Bestandes
ggplot(data=mat_verlauf_gruppeB, aes(x=EinAusDat, y=Bestand, fill=`Artikel-Bezeichnung`)) +
    facet_wrap(~`Artikel-Bezeichnung`, nrow=3, scales="free_y") +
    geom_point(size=0.3) +
    xlab("Zeit") + 
    ylab("Materialbestand") +
    theme(legend.position = "none")
```

# CRISP-DM Phase 4: Analyse
## Explorative Datenanalyse
- Inhalt
  - Bestandsverlauf der Materialien über die letzten Jahre
  - Einkaufs- und Abruflosgrößen
- Methoden
  - Statistiken
  - Visualisierungen
  - Korrelations-, Clusteranalysen, Association Rule Mining, ...

## Entscheidungsassistent
- Persona
  - Für den Einkauf
- Funktionalitäten
  - Relevante Informationen auf Materialebene bereitstellen
  - Vorschläge bezüglich Einkaufslosgröße und Beschaffungsstrategie machen
  - Auf Materialebene Informationen bereitstellen, die den Einkaufenden in den Unternehmensprozessen unterstützt (insb. Vorschläge bezüglich Einkaufslosgrößen und Bestellzeitpunkte)
  - Mehrere Zielgrößen denkbar, z.B. Materialverfügbarkeit, Lagerkosten oder Transportkosten
  - Dazu deskriptive und diagnostische Elemente für Drilldown durch User
  
# CRISP-DM Phase 5: Bewertung der Ergebnisse
- Wie schätzen wir unsere Ergebnisse ein?

# CRISP-DM Phase 6: Bereitstellung und Nutzengenerierung
- Wie würden wir unsere Ergebnisse/ unser Tool deployen?
- Wie wird damit ein Mehrwert generiert?
